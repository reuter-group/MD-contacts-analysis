*

bomblev -2

set segid proa

SET inp piplc_@{segid}memb

set begin 0

set skip 1

! protein topology and parameter
open read card unit 10 name toppar_mass_orig/top_all36_prot.rtf
read  rtf card unit 10

open read card unit 20 name toppar_mass_orig/par_all36_prot.prm
read para card unit 20 flex


! lipids
open read card unit 10 name toppar_mass_orig/top_all36_lipid.rtf
read  rtf card unit 10 append

open read card unit 20 name toppar_mass_orig/par_all36_lipid.prm
read para card unit 20 append flex

! Additional topologies and parameters for water and ions
stream toppar_mass_orig/toppar_water_ions.str


!Initial psf 
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!puts @path/scr/@inp.dyna_desolv.psf when it is the beginning psf!
!puts @path/scr/@out/@out.dyna_desolv.psf when it is a new psf   !
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
open unit 1 card read name phosphod_bound_to_pure_popc.oldpsf
read psf card unit 1
close unit 1

! Initial coordinates
open unit 1 card read name phosphod_bound_to_pure_popc.crd 
read coor card unit 1
close unit 1

coor copy comp

define crit sele (( type H* .and. prop abs charge .lt. 0.1) .or. (type C* .and. prop abs charge .lt. 0.3)) end
define head sele segid memb .and. ( resn *pc .and. ( type c12 .or. type c13 .or. type c14 .or. type c15 .or. type h11a .or. type h11b .or. type c11 ) ) .or. -
                 ( resn *pg .and.  ( type h13a .or. type h13b .or. type c13 .or. type h12a .or. type c12 .or. type c11 .or. type h11a .or. type h11b ) ) end

print coor sele segid pro* .and. resi @resi .and. crit end

open read unformatted unit 10 name output/@dcd

COORdinates CONTact cuthb 3.0 firstu 10 nunit 1 skip @skip  -
        begin @begin stop @{conf_n} -
        sele segid @segid .and. resi @resi .and. crit end -
        sele segid MEMB .and. crit .and. ( .not. head ) end -
        VERB tcut 0.05

u
