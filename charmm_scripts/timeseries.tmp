* Timeseries template input
*

set inp phosphod_bound_to_pure_popc
! set dcd output/phospho_d_pure_popc_read
set dcd output/500frames

set chain proa

!!!!!!!!!!!!!!!!!!!!!!!!!!!
! Topology, parameters and PSF
!!!!!!!!!!!!!!!!!!!!!!!!!!!

open read card unit 10 name toppar_mass_orig/top_all36_prot.rtf
read rtf card unit 10

open read card unit 20 name toppar_mass_orig/par_all36_prot.prm
read para card unit 20 flex

! lipid
open read card unit 10 name toppar_mass_orig/top_all36_lipid.rtf
read rtf card unit 10 append

open read card unit 20 name toppar_mass_orig/par_all36_lipid.prm
read para card unit 20 append flex


stream toppar_mass_orig/toppar_water_ions.str


!  Read in psf and coordinates
open read formatted unit 20 name @inp.oldpsf
read psf card unit 20
open read formatted unit 21 name @inp.crd
read coor card unit 21
coor copy comp



OPEN UNIT 14 READ unformatted NAME @dcd.dcd

if @type eq cationpi goto cationpi

open unit 98 write form name angle.ts
correl maxseries 1 maxtimesteps 40004  maxatom 5
enter ts angle PROT 244 og PROT 244 hg1 MEMB 42 O14
  trajectory firstunit 14 nunits 1 skip 1 begin 0 stop 40004
  edit ts veccode 1! veccode as maxseries indicates the number of timeseries here two...
  write ts unit 98 card
*# JOBNAME: h-bonds
*
stop


label cationpi

if @resn ne phe goto zapphe
open unit 98 write form name @resn@resi.@lipid.cationpi.ts
correl maxseries 12 maxtimesteps 400000  maxatom 30
enter ts1 bond @chain @resi cz memb @lipid n
enter ts2 bond  @chain @resi cd1 memb @lipid n
enter ts3 bond  @chain @resi cd2 memb @lipid n
enter ts4  bond @chain @resi ce1 memb @lipid n
enter ts5 bond  @chain @resi ce2 memb @lipid n
enter ts6 bond @chain @resi cg memb @lipid n
  trajectory firstunit 14 nunits 1 skip @skip begin 0 stop @stop
  edit ts1 veccode 6! veccode as maxseries indicates the number of timeseries here two...
  write ts1 unit 98 card
*# JOBNAME: h-bonds
*
stop
label zapphe

if @resn ne tyr goto zaptyr
open unit 98 write form name @resn@resi.@lipid.cationpi.ts
correl maxseries 12 maxtimesteps 400000  maxatom 30
enter ts1  bond @chain @resi cg memb @lipid n
enter ts2  bond @chain @resi cd1 memb @lipid n
enter ts3  bond @chain @resi cd2 memb @lipid n
enter ts4  bond @chain @resi ce1 memb @lipid n
enter ts5  bond @chain @resi ce2 memb @lipid n
enter ts6  bond @chain @resi cz memb @lipid n
  trajectory firstunit 14 nunits 1 skip @skip begin 0 stop @stop
  edit ts1 veccode 6! veccode as maxseries indicates the number of timeseries here two...
  write ts1 unit 98 card
*# JOBNAME: h-bonds
*
stop
label zaptyr

if @resn ne trp goto zaptrp
open unit 98 write form name @resn@resi.@lipid.cationpi.ts
correl maxseries 12 maxtimesteps 400000  maxatom 30
enter ts1  bond @chain @resi cg memb @lipid n
enter ts2  bond @chain @resi cd1 memb @lipid n
enter ts3  bond @chain @resi ne1 memb @lipid n
enter ts4  bond @chain @resi cd2 memb @lipid n
enter ts5  bond @chain @resi ce2 memb @lipid n
enter ts6  bond @chain @resi ce3 memb @lipid n
enter ts7  bond @chain @resi cz2 memb @lipid n
enter ts8  bond @chain @resi cz3 memb @lipid n
enter ts9  bond @chain @resi ch2 memb @lipid n
  trajectory firstunit 14 nunits 1 skip @skip begin 0 stop @stop
  edit ts1 veccode 9! veccode as maxseries indicates the number of timeseries here two...
  write ts1 unit 98 card
*# JOBNAME: h-bonds
*
stop
label zaptrp
